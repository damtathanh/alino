This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
public/
  logo/
    logo.png
src/
  components/
    layout/
      Footer.tsx
      Header.tsx
      UserMenu.tsx
    AuthGate.tsx
  hooks/
    useAuth.ts
    useProfile.ts
  lib/
    supabase.ts
  pages/
    AppGate.tsx
    BrandDashboard.tsx
    CreatorDashboard.tsx
    LandingPage.tsx
    LoginPage.tsx
    OnboardingPage.tsx
    ProfilePage.tsx
    RolePage.tsx
    SettingsPage.tsx
    SignupPage.tsx
    VerifyEmailPage.tsx
  types/
    profile.ts
  App.tsx
  index.css
  main.tsx
  router.tsx
  vite-env.d.ts
supabase/
  migrations/
    001_create_profiles.sql
.env.example
.gitignore
index.html
MIGRATION_GUIDE.md
package.json
postcss.config.cjs
PROFILES_IMPLEMENTATION.md
README_VITE.md
README.md
tailwind.config.js
TECHNICAL_SUMMARY.md
tsconfig.json
vite.config.ts
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="src/pages/AppGate.tsx">
import { useEffect, useState } from 'react'
import { useNavigate, useSearchParams } from 'react-router-dom'
import { useAuth } from '../hooks/useAuth'
import { getSupabase } from '../lib/supabase'

export default function AppGate() {
  const { session, loading: authLoading } = useAuth()
  const navigate = useNavigate()
  const [searchParams] = useSearchParams()
  const supabase = getSupabase()
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    if (authLoading) return

    // a) No session → redirect to landing
    if (!session) {
      navigate('/', { replace: true })
      return
    }

    // b) Email NOT verified → sign out → redirect to /
    if (!session.user.email_confirmed_at) {
      supabase.auth.signOut().finally(() => {
        navigate('/', { replace: true })
      })
      return
    }

    // c) Fetch profile DIRECTLY from Supabase (no cached hook)
    runGate()
  }, [authLoading, session, navigate, supabase])

  async function runGate() {
    if (!session) return

    setLoading(true)

    try {
      // Fetch profile directly from Supabase
      const { data: profile, error } = await supabase
        .from('profiles')
        .select('id, role, onboarding_completed')
        .eq('id', session.user.id)
        .single()

      // d) If profile does NOT exist → insert profile → redirect /role
      if (error && error.code === 'PGRST116') {
        const { error: insertError } = await supabase
          .from('profiles')
          .insert({
            id: session.user.id,
            role: null,
            onboarding_completed: false,
          })

        if (insertError) throw insertError

        navigate('/role', { replace: true })
        return
      }

      if (error) throw error

      // e) If profile.role is null → redirect /role
      if (!profile.role) {
        navigate('/role', { replace: true })
        return
      }

      // f) If onboarding_completed is false → redirect /onboarding
      if (!profile.onboarding_completed) {
        navigate('/onboarding', { replace: true })
        return
      }

      // g) Else → redirect /dashboard (or next param)
      const next = searchParams.get('next')
      if (next === 'projects' || next === 'profile' || next === 'settings') {
        navigate(`/${next}`, { replace: true })
      } else {
        navigate('/dashboard', { replace: true })
      }
    } catch (error) {
      console.error('AppGate error:', error)
      navigate('/', { replace: true })
    } finally {
      setLoading(false)
    }
  }

  if (authLoading || loading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-[#6B7280]">Đang tải...</div>
      </div>
    )
  }

  return null
}
</file>

<file path="src/types/profile.ts">
export interface Profile {
  id: string
  role: 'creator' | 'brand' | null
  onboarding_completed: boolean
  onboarding_data?: OnboardingData
}

export interface OnboardingData {
  // Step 1 - Role
  role_selected_at?: string

  // Step 2 - Basic Identity
  // Creator fields
  display_name?: string
  avatar_url?: string
  country?: string
  city?: string
  birth_year?: number

  // Brand fields
  brand_name?: string
  industry?: string

  // Step 3 - Business/Creator Metrics
  // Creator fields
  creator_platforms?: string[]
  followers_count?: number
  avg_views?: number
  engagement_rate?: number
  content_categories?: string[]

  // Brand fields
  company_size?: string
  monthly_marketing_budget?: number
  target_platforms?: string[]

  // Step 4 - Collaboration Intent
  // Creator
  collaboration_expectation?: string
  // Brand
  collaboration_goal?: string
}
</file>

<file path="src/components/layout/Footer.tsx">
import { FaFacebook, FaInstagram, FaTiktok, FaYoutube, FaLinkedin, FaPhone, FaEnvelope, FaMapMarkerAlt } from 'react-icons/fa'

export default function Footer() {
  return (
    <footer className="relative pt-20 pb-8 bg-white border-t border-black/5">
      <div className="max-w-7xl mx-auto px-6">
        <div className="grid md:grid-cols-5 gap-12 mb-8">
          <div className="space-y-4">
            <div className="flex items-center gap-3">
              <img
                src="/logo/logo.png"
                alt="ALINO"
                className="w-7 h-7"
              />
              <span className="font-semibold text-lg tracking-tight bg-gradient-to-r from-[#6366F1] to-[#EC4899] bg-clip-text text-transparent">
                ALINO
              </span>
            </div>
            <p className="text-sm text-[#6B7280] leading-relaxed">
              Nền tảng hợp tác cho Creator và Brand chuyên nghiệp.
            </p>
            <div className="flex items-center gap-4 pt-2">
              <a
                href="https://facebook.com"
                target="_blank"
                rel="noopener noreferrer"
                className="text-[#9CA3AF] hover:text-[#1877F2] transition-colors hover:scale-110 transform duration-200"
              >
                <FaFacebook size={20} />
              </a>
              <a
                href="https://instagram.com"
                target="_blank"
                rel="noopener noreferrer"
                className="text-[#9CA3AF] hover:text-[#DD2A7B] transition-colors hover:scale-110 transform duration-200"
              >
                <FaInstagram size={20} />
              </a>
              <a
                href="https://tiktok.com"
                target="_blank"
                rel="noopener noreferrer"
                className="text-[#9CA3AF] hover:text-[#000000] transition-colors hover:scale-110 transform duration-200"
              >
                <FaTiktok size={20} />
              </a>
              <a
                href="https://youtube.com"
                target="_blank"
                rel="noopener noreferrer"
                className="text-[#9CA3AF] hover:text-[#FF0000] transition-colors hover:scale-110 transform duration-200"
              >
                <FaYoutube size={20} />
              </a>
              <a
                href="https://linkedin.com"
                target="_blank"
                rel="noopener noreferrer"
                className="text-[#9CA3AF] hover:text-[#0A66C2] transition-colors hover:scale-110 transform duration-200"
              >
                <FaLinkedin size={20} />
              </a>
            </div>
          </div>

          <div>
            <h4 className="font-semibold text-sm mb-4 tracking-tight">Sản phẩm</h4>
            <ul className="space-y-3 text-sm text-[#6B7280]">
              <li>
                <a href="#product" className="hover:text-[#6366F1] transition-colors">
                  Tính năng
                </a>
              </li>
              <li>
                <a href="#pricing" className="hover:text-[#6366F1] transition-colors">
                  Bảng giá
                </a>
              </li>
              <li>
                <a href="#how-it-works" className="hover:text-[#6366F1] transition-colors">
                  Cách hoạt động
                </a>
              </li>
            </ul>
          </div>

          <div>
            <h4 className="font-semibold text-sm mb-4 tracking-tight">Công ty</h4>
            <ul className="space-y-3 text-sm text-[#6B7280]">
              <li>
                <a href="#about" className="hover:text-[#6366F1] transition-colors">
                  Về chúng tôi
                </a>
              </li>
              <li>
                <a href="#news" className="hover:text-[#6366F1] transition-colors">
                  Tin tức
                </a>
              </li>
              <li>
                <a href="#contact" className="hover:text-[#6366F1] transition-colors">
                  Liên hệ
                </a>
              </li>
            </ul>
          </div>

          <div>
            <h4 className="font-semibold text-sm mb-4 tracking-tight">Pháp lý</h4>
            <ul className="space-y-3 text-sm text-[#6B7280]">
              <li>
                <a href="#terms" className="hover:text-[#6366F1] transition-colors">
                  Điều khoản sử dụng
                </a>
              </li>
              <li>
                <a href="#privacy" className="hover:text-[#6366F1] transition-colors">
                  Chính sách bảo mật
                </a>
              </li>
            </ul>
          </div>

          <div>
            <h4 className="font-semibold text-sm mb-4 tracking-tight">Liên hệ</h4>
            <ul className="space-y-3 text-sm text-[#6B7280]">
              <li className="flex items-start gap-3">
                <FaPhone className="mt-0.5 flex-shrink-0" size={16} />
                <a href="tel:+84707970216" className="hover:text-[#6366F1] transition-colors">
                  +84 707 970 216
                </a>
              </li>
              <li className="flex items-start gap-3">
                <FaEnvelope className="mt-0.5 flex-shrink-0" size={16} />
                <a href="mailto:contact@alino.net" className="hover:text-[#6366F1] transition-colors">
                  contact@alino.net
                </a>
              </li>
              <li className="flex items-start gap-3 leading-relaxed">
                <FaMapMarkerAlt className="mt-0.5 flex-shrink-0" size={16} />
                <span>
                  Landmark 81
                  <br />
                  720A Điện Biên Phủ, Phường 22, Quận Bình Thạnh, TP. Hồ Chí Minh, Việt Nam
                </span>
              </li>
            </ul>
          </div>
        </div>

        <div className="pt-8 border-t border-black/5 text-center text-sm text-[#9CA3AF]">
          © 2025 ALINO. All rights reserved.
        </div>
      </div>
    </footer>
  )
}
</file>

<file path="src/components/layout/Header.tsx">
import { Link, useLocation, useNavigate } from 'react-router-dom'
import { useAuth } from '../../hooks/useAuth'
import UserMenu from './UserMenu'

export default function Header() {
  const { session, loading } = useAuth()
  const location = useLocation()
  const navigate = useNavigate()

  const handleLogoClick = (e: React.MouseEvent) => {
    e.preventDefault()
    if (location.pathname !== '/') {
      navigate('/')
    }
    window.scrollTo({ top: 0, behavior: 'smooth' })
  }

  return (
    <header className="fixed top-0 inset-x-0 z-50 h-16 bg-white/80 backdrop-blur-xl border-b border-black/5">
      <div className="max-w-7xl mx-auto px-6 h-full flex items-center justify-between">
        <Link
          to="/"
          onClick={handleLogoClick}
          className="flex items-center gap-3 cursor-pointer"
        >
          <img src="/logo/logo.png" alt="ALINO" className="w-8 h-8" />
          <span className="font-semibold text-lg tracking-tight bg-gradient-to-r from-[#6366F1] to-[#EC4899] bg-clip-text text-transparent">
            ALINO
          </span>
        </Link>

        <nav className="hidden md:flex items-center gap-10 text-sm text-[#6B7280]">
          <a href="#about">Về chúng tôi</a>
          <a href="#product">Sản phẩm</a>
          <a href="#news">Tin tức</a>
          <a href="#contact">Liên hệ</a>
        </nav>

        <div className="flex items-center gap-4 text-sm">
          {loading ? null : session ? (
            <UserMenu userEmail={session.user.email || ''} />
          ) : (
            <>
              <Link to="/login">Đăng nhập</Link>
              <Link
                to="/signup"
                className="px-5 py-2.5 rounded-full text-white bg-gradient-to-r from-[#6366F1] to-[#EC4899]"
              >
                Đăng ký
              </Link>
            </>
          )}
        </div>
      </div>
    </header>
  )
}
</file>

<file path="src/components/layout/UserMenu.tsx">
import { useState, useRef, useEffect } from 'react'
import { Link, useNavigate } from 'react-router-dom'
import { useAuth } from '../../hooks/useAuth'

interface UserMenuProps {
  userEmail: string
  displayName?: string
  role?: string | null
}

export default function UserMenu({ userEmail, displayName, role }: UserMenuProps) {
  const [isOpen, setIsOpen] = useState(false)
  const menuRef = useRef<HTMLDivElement>(null)
  const navigate = useNavigate()
  const { signOut } = useAuth()

  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {
        setIsOpen(false)
      }
    }

    if (isOpen) {
      document.addEventListener('mousedown', handleClickOutside)
    }

    return () => {
      document.removeEventListener('mousedown', handleClickOutside)
    }
  }, [isOpen])

  const handleLogout = async () => {
    setIsOpen(false)
    await signOut()
  }

  const dashboardPath = '/app?next=projects'

  const nameToShow = displayName || userEmail.split('@')[0]

  return (
    <div
      className="relative"
      ref={menuRef}
      onMouseEnter={() => setIsOpen(true)}
      onMouseLeave={() => setIsOpen(false)}
    >
      <button
        onClick={() => setIsOpen(!isOpen)}
        className="flex items-center gap-2 px-0 py-0 text-[#6B7280] hover:text-[#6366F1] transition-colors group"
      >
        <div className="w-6 h-6 rounded-full bg-gradient-to-r from-[#6366F1] to-[#EC4899] flex items-center justify-center text-white font-medium text-xs flex-shrink-0">
          {nameToShow.charAt(0).toUpperCase()}
        </div>
        <span className="text-sm whitespace-nowrap">
          {nameToShow}
        </span>
      </button>

      {isOpen && (
        <div className="absolute right-0 top-full pt-2 w-56 z-50">
          <div className="bg-white rounded-xl shadow-lg border border-gray-200 py-2">
            <Link
              to={dashboardPath}
              onClick={() => setIsOpen(false)}
              className="block px-4 py-2.5 text-sm text-[#374151] hover:bg-gray-50 transition-colors"
            >
              Quản lý dự án
            </Link>
            <Link
              to="/app?next=profile"
              onClick={() => setIsOpen(false)}
              className="block px-4 py-2.5 text-sm text-[#374151] hover:bg-gray-50 transition-colors"
            >
              Hồ sơ
            </Link>
            <Link
              to="/app?next=settings"
              onClick={() => setIsOpen(false)}
              className="block px-4 py-2.5 text-sm text-[#374151] hover:bg-gray-50 transition-colors"
            >
              Cài đặt
            </Link>
            <div className="border-t border-gray-200 my-1" />
            <button
              onClick={handleLogout}
              className="block w-full text-left px-4 py-2.5 text-sm text-red-600 hover:bg-gray-50 transition-colors"
            >
              Đăng xuất
            </button>
          </div>
        </div>
      )}
    </div>
  )
}
</file>

<file path="src/components/AuthGate.tsx">
import { useEffect } from 'react'
import { useNavigate } from 'react-router-dom'
import { useAuth } from '../hooks/useAuth'
import { useProfile } from '../hooks/useProfile'

export default function AuthGate({ children }: { children: React.ReactNode }) {
  const { session, loading: authLoading, isAuthenticated } = useAuth()
  const { profile, loading: profileLoading } = useProfile(
    session?.user?.id,
    isAuthenticated
  )
  const navigate = useNavigate()

  useEffect(() => {
    if (authLoading || profileLoading) return

    if (!session) {
      navigate('/login', { replace: true })
      return
    }

    if (!profile) return

    if (!profile.role) {
      navigate('/role', { replace: true })
      return
    }

    if (!profile.onboarding_completed) {
      navigate('/onboarding', { replace: true })
      return
    }
  }, [session, profile, authLoading, profileLoading, navigate])

  if (authLoading || profileLoading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        Đang tải...
      </div>
    )
  }

  return <>{children}</>
}
</file>

<file path="src/hooks/useAuth.ts">
import { useEffect, useState } from 'react'
import { useNavigate } from 'react-router-dom'
import type { Session } from '@supabase/supabase-js'
import { getSupabase } from '../lib/supabase'

export function useAuth() {
  const [session, setSession] = useState<Session | null>(null)
  const [loading, setLoading] = useState(true)
  const navigate = useNavigate()
  const supabase = getSupabase()

  useEffect(() => {
    let mounted = true

    // Get initial session
    supabase.auth.getSession().then(({ data: { session } }) => {
      if (!mounted) return
      setSession(session)
      setLoading(false)
    })

    // Listen for auth changes
    const {
      data: { subscription },
    } = supabase.auth.onAuthStateChange((event, session) => {
      if (!mounted) return
      setSession(session)
      setLoading(false)
    })

    return () => {
      mounted = false
      subscription.unsubscribe()
    }
  }, [])

  const signOut = async () => {
    await supabase.auth.signOut()
    setSession(null)
    navigate('/')
  }

  return {
    session,
    user: session?.user ?? null,
    loading,
    signOut,
    isAuthenticated: !!session,
  }
}
</file>

<file path="src/hooks/useProfile.ts">
import { useEffect, useState } from 'react'
import { getSupabase } from '../lib/supabase'

interface Profile {
  id: string
  role: 'creator' | 'brand' | null
  onboarding_completed: boolean
  onboarding_data?: any
}

export function useProfile(
  userId: string | undefined,
  enabled: boolean
) {
  const [profile, setProfile] = useState<Profile | null>(null)
  const [loading, setLoading] = useState(true)
  const supabase = getSupabase()

  useEffect(() => {
    if (!enabled || !userId) {
      setProfile(null)
      setLoading(false)
      return
    }

    let mounted = true

    async function fetchProfile() {
      setLoading(true)

      try {
        const { data, error } = await supabase
          .from('profiles')
          .select('id, role, onboarding_completed, onboarding_data')
          .eq('id', userId)
          .single()

        if (error) throw error

        if (mounted) {
          setProfile(data)
          setLoading(false)
        }
      } catch (err) {
        if (mounted) {
          setProfile(null)
          setLoading(false)
        }
      }
    }

    fetchProfile()

    return () => {
      mounted = false
    }
  }, [userId, enabled])

  return { profile, loading }
}
</file>

<file path="src/lib/supabase.ts">
import { createClient } from '@supabase/supabase-js'
import type { SupabaseClient } from '@supabase/supabase-js'

const supabaseUrl = import.meta.env.VITE_SUPABASE_URL
const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY

if (!supabaseUrl || !supabaseAnonKey) {
  throw new Error('Missing Supabase environment variables')
}

let supabaseClient: SupabaseClient | null = null

export function getSupabase() {
  if (!supabaseClient) {
    supabaseClient = createClient(supabaseUrl, supabaseAnonKey, {
      auth: {
        persistSession: true,
        autoRefreshToken: true,
        detectSessionInUrl: true,
      },
    })
  }

  return supabaseClient
}
</file>

<file path="src/pages/BrandDashboard.tsx">
export default function BrandDashboard() {
  return (
    <div className="min-h-screen bg-gradient-to-br from-[#EEF1FF] via-[#F5F7FF] to-white py-20 px-6 pt-24">
      <div className="max-w-7xl mx-auto">
        <div className="bg-white/90 backdrop-blur-xl rounded-3xl p-12 shadow-xl border border-black/5 text-center">
          <h1 className="text-4xl font-semibold tracking-tight mb-4">
            Brand Dashboard
          </h1>
          <p className="text-lg text-[#6B7280]">
            Trang này đang được phát triển
          </p>
        </div>
      </div>
    </div>
  )
}
</file>

<file path="src/pages/CreatorDashboard.tsx">
export default function CreatorDashboard() {
  return (
    <div className="min-h-screen bg-gradient-to-br from-[#EEF1FF] via-[#F5F7FF] to-white py-20 px-6 pt-24">
      <div className="max-w-7xl mx-auto">
        <div className="bg-white/90 backdrop-blur-xl rounded-3xl p-12 shadow-xl border border-black/5 text-center">
          <h1 className="text-4xl font-semibold tracking-tight mb-4">
            Creator Dashboard
          </h1>
          <p className="text-lg text-[#6B7280]">
            Trang này đang được phát triển
          </p>
        </div>
      </div>
    </div>
  )
}
</file>

<file path="src/pages/LandingPage.tsx">
import { useEffect, useState } from 'react'
import { Link, useSearchParams } from 'react-router-dom'

export default function LandingPage() {
  const [searchParams, setSearchParams] = useSearchParams()
  const [showMessage, setShowMessage] = useState(false)

  useEffect(() => {
    if (searchParams.get('signup') === 'success') {
      setShowMessage(true)
      // Remove query param from URL
      setSearchParams({}, { replace: true })
    }
  }, [searchParams, setSearchParams])

  return (
    <div className="relative overflow-x-hidden bg-white pt-16">
      <div className="min-h-screen">
        <section className="max-w-7xl mx-auto px-6 py-20">
          <div className="text-center">
            {showMessage && (
              <div className="mb-8 max-w-2xl mx-auto">
                <div className="bg-green-50 border border-green-200 rounded-xl p-4 text-green-700">
                  <p className="font-medium">
                    Vui lòng kiểm tra email để xác thực tài khoản.
                  </p>
                </div>
              </div>
            )}
            <h1 className="text-5xl md:text-6xl font-bold mb-6 bg-gradient-to-r from-[#6366F1] to-[#EC4899] bg-clip-text text-transparent">
              Quản lý hợp tác Creator–Brand
            </h1>
            <p className="text-xl text-[#6B7280] mb-8 max-w-2xl mx-auto">
              Nền tảng quản lý hợp tác chuyên nghiệp giữa Creator và Brand
            </p>
            <div className="flex gap-4 justify-center">
              <Link
                to="/signup"
                className="px-8 py-3 rounded-full font-semibold text-white bg-gradient-to-r from-[#6366F1] to-[#EC4899] hover:scale-105 transition-transform shadow-lg shadow-[#6366F1]/25"
              >
                Bắt đầu ngay
              </Link>
              <Link
                to="/login"
                className="px-8 py-3 rounded-full font-semibold text-[#6366F1] border-2 border-[#6366F1] hover:bg-[#6366F1] hover:text-white transition-colors"
              >
                Đăng nhập
              </Link>
            </div>
          </div>
        </section>
      </div>
    </div>
  )
}
</file>

<file path="src/pages/LoginPage.tsx">
import { useState } from 'react'
import { Link, useNavigate } from 'react-router-dom'
import { getSupabase } from '../lib/supabase'

export default function LoginPage() {
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [error, setError] = useState('')
  const [loading, setLoading] = useState(false)
  const navigate = useNavigate()
  const supabase = getSupabase()

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault()
    setError('')
    setLoading(true)

    try {
      const { error } = await supabase.auth.signInWithPassword({
        email,
        password,
      })

      if (error) {
        // Map error messages to Vietnamese
        if (error.message === 'Email not confirmed') {
          setError('Tài khoản chưa được xác thực')
        } else {
          setError('Email hoặc mật khẩu không đúng')
        }
        setLoading(false)
        return
      }

      navigate('/app')
    } catch (err) {
      setError('Có lỗi xảy ra')
      setLoading(false)
    }
  }

  const handleGoogleLogin = async () => {
    const { data, error } = await supabase.auth.signInWithOAuth({
      provider: 'google',
      options: {
        redirectTo: `${window.location.origin}/app`,
      },
    })

    if (error) {
      setError(error.message)
      return
    }

    if (data.url) {
      window.location.href = data.url
    }
  }

  return (
    <div className="min-h-screen flex items-center justify-center bg-[#F9FAFB] px-6 lg:px-6 pt-16">
      <div className="w-full max-w-6xl bg-white rounded-3xl shadow-xl overflow-hidden flex">
        <div className="hidden lg:flex w-[45%] bg-gradient-to-br from-[#6366F1]/20 via-[#7C3AED]/15 to-[#EC4899]/20">
          <div className="flex flex-col px-12 pt-12 items-center">
            <img
              src="/logo/logo.png"
              alt="ALINO"
              className="w-40 h-40 mb-6"
            />
            <h1 className="text-3xl font-semibold text-[#1F2937] mb-3">
              Chào mừng tới với Alino
            </h1>
            <p className="text-[#6B7280] leading-relaxed">
              Nền tảng quản lý các dự án hợp tác chuyên nghiệp
            </p>
          </div>
        </div>

        <div className="w-full lg:w-[55%] px-10 py-8 flex items-center justify-center">
          <div className="w-full max-w-sm">
            <h2 className="text-2xl font-semibold mb-2">Đăng nhập</h2>
            <p className="text-sm text-[#6B7280] mb-6">
              Nhập thông tin để tiếp tục
            </p>

            {error && (
              <div className="mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm">
                {error}
              </div>
            )}

            <form onSubmit={handleSubmit} className="space-y-4">
              <input
                type="email"
                placeholder="Email"
                value={email}
                onChange={(e) => setEmail(e.target.value)}
                className="w-full px-3 py-2.5 border rounded-lg"
                required
              />

              <input
                type="password"
                placeholder="Mật khẩu"
                value={password}
                onChange={(e) => setPassword(e.target.value)}
                className="w-full px-3 py-2.5 border rounded-lg"
                required
              />

              <button
                type="submit"
                disabled={loading}
                className="w-full py-2.5 rounded-lg text-white font-medium bg-gradient-to-r from-[#6366F1] to-[#EC4899] disabled:opacity-50"
              >
                {loading ? 'Đang đăng nhập...' : 'Đăng nhập'}
              </button>
            </form>

            <div className="my-5 text-center text-xs text-[#9CA3AF]">HOẶC</div>

            <button
              onClick={handleGoogleLogin}
              className="w-full py-2.5 border rounded-lg text-sm hover:bg-gray-50 flex items-center justify-center gap-3"
            >
              <svg className="w-5 h-5" viewBox="0 0 24 24">
                <path
                  fill="#4285F4"
                  d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"
                />
                <path
                  fill="#34A853"
                  d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"
                />
                <path
                  fill="#FBBC05"
                  d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"
                />
                <path
                  fill="#EA4335"
                  d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"
                />
              </svg>
              Đăng nhập với Google
            </button>

            <p className="mt-6 text-center text-sm text-[#6B7280]">
              Chưa có tài khoản?{' '}
              <Link to="/signup" className="text-[#6366F1] font-medium">
                Đăng ký
              </Link>
            </p>
          </div>
        </div>
      </div>
    </div>
  )
}
</file>

<file path="src/pages/OnboardingPage.tsx">
import { useState, useEffect } from 'react'
import { useNavigate } from 'react-router-dom'
import { useAuth } from '../hooks/useAuth'
import { getSupabase } from '../lib/supabase'
import type { OnboardingData } from '../types/profile'

export default function OnboardingPage() {
  const { session } = useAuth()
  const navigate = useNavigate()
  const supabase = getSupabase()
  const [currentStep, setCurrentStep] = useState(1)
  const [loading, setLoading] = useState(false)
  const [error, setError] = useState('')

  // Form state
  const [formData, setFormData] = useState<OnboardingData>({})

  useEffect(() => {
    if (!session) {
      navigate('/app', { replace: true })
      return
    }

    // Check if onboarding already completed
    checkOnboardingStatus()
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [session])

  async function checkOnboardingStatus() {
    if (!session) return

    try {
      const { data, error } = await supabase
        .from('profiles')
        .select('onboarding_completed, role')
        .eq('id', session.user.id)
        .single()

      if (error && error.code !== 'PGRST116') throw error

      if (data?.onboarding_completed) {
        navigate('/app', { replace: true })
        return
      }

      if (data?.role) {
        // Load existing data
        loadExistingData()
      }
    } catch (err) {
      console.error('Error checking onboarding:', err)
    }
  }

  async function loadExistingData() {
    if (!session) return

    try {
      const { data, error } = await supabase
        .from('profiles')
        .select('onboarding_data, role')
        .eq('id', session.user.id)
        .single()

      if (error) throw error

      if (data?.onboarding_data && typeof data.onboarding_data === 'object') {
        setFormData(data.onboarding_data as OnboardingData)
      }

      // Determine current step based on existing data
      if (data?.role) {
        if (!data.onboarding_data || Object.keys(data.onboarding_data).length === 0) {
          setCurrentStep(2)
        } else {
          const od = data.onboarding_data as OnboardingData
          if (!od.display_name && !od.brand_name) {
            setCurrentStep(2)
          } else if (!od.creator_platforms && !od.company_size) {
            setCurrentStep(3)
          } else if (!od.collaboration_expectation && !od.collaboration_goal) {
            setCurrentStep(4)
          } else {
            setCurrentStep(5)
          }
        }
      }
    } catch (err) {
      console.error('Error loading existing data:', err)
    }
  }

  async function saveStep(stepData: Partial<OnboardingData>, nextStep?: number) {
    if (!session) return

    setLoading(true)
    setError('')

    try {
      const updatedData = { ...formData, ...stepData }
      setFormData(updatedData)

      const { error } = await supabase
        .from('profiles')
        .update({
          onboarding_data: updatedData,
        })
        .eq('id', session.user.id)

      if (error) throw error

      if (nextStep) {
        setCurrentStep(nextStep)
      }
    } catch (err: any) {
      setError(err.message || 'Có lỗi xảy ra khi lưu dữ liệu')
    } finally {
      setLoading(false)
    }
  }

  async function handleComplete() {
    if (!session) return

    setLoading(true)
    setError('')

    try {
      const finalData = {
        ...formData,
        onboarding_completed_at: new Date().toISOString(),
      }

      const { error } = await supabase
        .from('profiles')
        .update({
          onboarding_completed: true,
          onboarding_data: finalData,
        })
        .eq('id', session.user.id)

      if (error) throw error

      navigate('/app', { replace: true })
    } catch (err: any) {
      setError(err.message || 'Có lỗi xảy ra khi hoàn tất onboarding')
      setLoading(false)
    }
  }

  const [role, setRole] = useState<'creator' | 'brand' | null>(null)

  useEffect(() => {
    async function getRole() {
      if (!session) return null
      const { data } = await supabase
        .from('profiles')
        .select('role')
        .eq('id', session.user.id)
        .single()
      return data?.role || null
    }
    getRole().then(setRole)
  }, [session, supabase])

  if (!role) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-[#6B7280]">Đang tải...</div>
      </div>
    )
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-[#EEF1FF] via-[#F5F7FF] to-white py-20 px-6 pt-24">
      <div className="max-w-3xl mx-auto">
        <div className="bg-white/90 backdrop-blur-xl rounded-3xl p-8 md:p-10 shadow-xl border border-black/5">
          {/* Progress indicator */}
          <div className="mb-8">
            <div className="flex items-center justify-between mb-2">
              <span className="text-sm text-[#6B7280]">
                Bước {currentStep} / 5
              </span>
              <span className="text-sm text-[#6B7280]">
                {Math.round((currentStep / 5) * 100)}%
              </span>
            </div>
            <div className="w-full bg-gray-200 rounded-full h-2">
              <div
                className="bg-gradient-to-r from-[#6366F1] to-[#EC4899] h-2 rounded-full transition-all"
                style={{ width: `${(currentStep / 5) * 100}%` }}
              />
            </div>
          </div>

          {error && (
            <div className="mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm">
              {error}
            </div>
          )}

          {/* Step 2: Basic Identity */}
          {currentStep === 2 && (
            <Step2BasicIdentity
              role={role}
              formData={formData}
              onSave={(data) => saveStep(data, 3)}
              loading={loading}
            />
          )}

          {/* Step 3: Business/Creator Metrics */}
          {currentStep === 3 && (
            <Step3Metrics
              role={role}
              formData={formData}
              onSave={(data) => saveStep(data, 4)}
              loading={loading}
            />
          )}

          {/* Step 4: Collaboration Intent */}
          {currentStep === 4 && (
            <Step4Collaboration
              role={role}
              formData={formData}
              onSave={(data) => saveStep(data, 5)}
              loading={loading}
            />
          )}

          {/* Step 5: Finalize */}
          {currentStep === 5 && (
            <Step5Finalize
              role={role}
              formData={formData}
              onComplete={handleComplete}
              loading={loading}
            />
          )}

          {/* Navigation buttons */}
          {currentStep > 2 && (
            <div className="mt-6 flex justify-between">
              <button
                onClick={() => setCurrentStep(currentStep - 1)}
                disabled={loading}
                className="px-6 py-2.5 rounded-xl font-medium text-[#6B7280] border border-gray-300 hover:bg-gray-50 disabled:opacity-50"
              >
                Quay lại
              </button>
            </div>
          )}
        </div>
      </div>
    </div>
  )
}

// Step 2: Basic Identity
function Step2BasicIdentity({
  role,
  formData,
  onSave,
  loading,
}: {
  role: 'creator' | 'brand'
  formData: OnboardingData
  onSave: (data: Partial<OnboardingData>) => void
  loading: boolean
}) {
  const [localData, setLocalData] = useState({
    display_name: formData.display_name || '',
    brand_name: formData.brand_name || '',
    country: formData.country || '',
    city: formData.city || '',
    birth_year: formData.birth_year || undefined,
    industry: formData.industry || '',
  })

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault()
    if (role === 'creator') {
      onSave({
        display_name: localData.display_name,
        country: localData.country,
        city: localData.city,
        birth_year: localData.birth_year,
      })
    } else {
      onSave({
        brand_name: localData.brand_name,
        industry: localData.industry,
        country: localData.country,
        city: localData.city,
      })
    }
  }

  return (
    <form onSubmit={handleSubmit}>
      <h1 className="text-3xl font-semibold tracking-tight mb-4">
        Thông tin cơ bản
      </h1>
      <p className="text-[#6B7280] mb-8">
        {role === 'creator' ? 'Hãy cho chúng tôi biết về bạn' : 'Hãy cho chúng tôi biết về thương hiệu của bạn'}
      </p>

      <div className="space-y-4">
        {role === 'creator' ? (
          <>
            <div>
              <label className="block text-sm font-medium text-[#374151] mb-2">
                Tên hiển thị *
              </label>
              <input
                type="text"
                value={localData.display_name}
                onChange={(e) => setLocalData({ ...localData, display_name: e.target.value })}
                className="w-full px-4 py-2.5 border rounded-lg"
                required
              />
            </div>
            <div>
              <label className="block text-sm font-medium text-[#374151] mb-2">
                Quốc gia *
              </label>
              <input
                type="text"
                value={localData.country}
                onChange={(e) => setLocalData({ ...localData, country: e.target.value })}
                className="w-full px-4 py-2.5 border rounded-lg"
                required
              />
            </div>
            <div>
              <label className="block text-sm font-medium text-[#374151] mb-2">
                Thành phố *
              </label>
              <input
                type="text"
                value={localData.city}
                onChange={(e) => setLocalData({ ...localData, city: e.target.value })}
                className="w-full px-4 py-2.5 border rounded-lg"
                required
              />
            </div>
            <div>
              <label className="block text-sm font-medium text-[#374151] mb-2">
                Năm sinh
              </label>
              <input
                type="number"
                min="1950"
                max={new Date().getFullYear()}
                value={localData.birth_year || ''}
                onChange={(e) => setLocalData({ ...localData, birth_year: e.target.value ? parseInt(e.target.value) : undefined })}
                className="w-full px-4 py-2.5 border rounded-lg"
              />
            </div>
          </>
        ) : (
          <>
            <div>
              <label className="block text-sm font-medium text-[#374151] mb-2">
                Tên thương hiệu *
              </label>
              <input
                type="text"
                value={localData.brand_name}
                onChange={(e) => setLocalData({ ...localData, brand_name: e.target.value })}
                className="w-full px-4 py-2.5 border rounded-lg"
                required
              />
            </div>
            <div>
              <label className="block text-sm font-medium text-[#374151] mb-2">
                Ngành nghề *
              </label>
              <input
                type="text"
                value={localData.industry}
                onChange={(e) => setLocalData({ ...localData, industry: e.target.value })}
                className="w-full px-4 py-2.5 border rounded-lg"
                required
              />
            </div>
            <div>
              <label className="block text-sm font-medium text-[#374151] mb-2">
                Quốc gia *
              </label>
              <input
                type="text"
                value={localData.country}
                onChange={(e) => setLocalData({ ...localData, country: e.target.value })}
                className="w-full px-4 py-2.5 border rounded-lg"
                required
              />
            </div>
            <div>
              <label className="block text-sm font-medium text-[#374151] mb-2">
                Thành phố *
              </label>
              <input
                type="text"
                value={localData.city}
                onChange={(e) => setLocalData({ ...localData, city: e.target.value })}
                className="w-full px-4 py-2.5 border rounded-lg"
                required
              />
            </div>
          </>
        )}

        <button
          type="submit"
          disabled={loading}
          className="w-full px-6 py-2.5 rounded-xl font-medium text-white bg-gradient-to-r from-[#6366F1] to-[#EC4899] disabled:opacity-50"
        >
          {loading ? 'Đang lưu...' : 'Tiếp tục'}
        </button>
      </div>
    </form>
  )
}

// Step 3: Business/Creator Metrics
function Step3Metrics({
  role,
  formData,
  onSave,
  loading,
}: {
  role: 'creator' | 'brand'
  formData: OnboardingData
  onSave: (data: Partial<OnboardingData>) => void
  loading: boolean
}) {
  const platforms = ['TikTok', 'Instagram', 'YouTube', 'Facebook', 'Twitter', 'LinkedIn']
  
  const [localData, setLocalData] = useState({
    creator_platforms: formData.creator_platforms || [],
    followers_count: formData.followers_count || undefined,
    avg_views: formData.avg_views || undefined,
    engagement_rate: formData.engagement_rate || undefined,
    content_categories: formData.content_categories || [],
    company_size: formData.company_size || '',
    monthly_marketing_budget: formData.monthly_marketing_budget || undefined,
    target_platforms: formData.target_platforms || [],
  })

  const togglePlatform = (platform: string, type: 'creator' | 'target') => {
    if (type === 'creator') {
      const current = localData.creator_platforms || []
      const updated = current.includes(platform)
        ? current.filter((p) => p !== platform)
        : [...current, platform]
      setLocalData({ ...localData, creator_platforms: updated })
    } else {
      const current = localData.target_platforms || []
      const updated = current.includes(platform)
        ? current.filter((p) => p !== platform)
        : [...current, platform]
      setLocalData({ ...localData, target_platforms: updated })
    }
  }

  const toggleCategory = (category: string) => {
    const current = localData.content_categories || []
    const updated = current.includes(category)
      ? current.filter((c) => c !== category)
      : [...current, category]
    setLocalData({ ...localData, content_categories: updated })
  }

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault()
    if (role === 'creator') {
      onSave({
        creator_platforms: localData.creator_platforms,
        followers_count: localData.followers_count,
        avg_views: localData.avg_views,
        engagement_rate: localData.engagement_rate,
        content_categories: localData.content_categories,
      })
    } else {
      onSave({
        company_size: localData.company_size,
        monthly_marketing_budget: localData.monthly_marketing_budget,
        target_platforms: localData.target_platforms,
      })
    }
  }

  const categories = ['Beauty', 'Fashion', 'Food', 'Travel', 'Tech', 'Fitness', 'Lifestyle', 'Education']

  return (
    <form onSubmit={handleSubmit}>
      <h1 className="text-3xl font-semibold tracking-tight mb-4">
        {role === 'creator' ? 'Thông tin Creator' : 'Thông tin Brand'}
      </h1>
      <p className="text-[#6B7280] mb-8">
        {role === 'creator' ? 'Chia sẻ về kênh và nội dung của bạn' : 'Chia sẻ về quy mô và ngân sách marketing'}
      </p>

      <div className="space-y-4">
        {role === 'creator' ? (
          <>
            <div>
              <label className="block text-sm font-medium text-[#374151] mb-2">
                Nền tảng bạn sử dụng *
              </label>
              <div className="grid grid-cols-2 gap-2">
                {platforms.map((platform) => (
                  <button
                    key={platform}
                    type="button"
                    onClick={() => togglePlatform(platform, 'creator')}
                    className={`px-4 py-2 rounded-lg border text-sm ${
                      localData.creator_platforms?.includes(platform)
                        ? 'border-[#6366F1] bg-[#6366F1]/10 text-[#6366F1]'
                        : 'border-gray-300 hover:border-gray-400'
                    }`}
                  >
                    {platform}
                  </button>
                ))}
              </div>
            </div>
            <div>
              <label className="block text-sm font-medium text-[#374151] mb-2">
                Số lượng người theo dõi
              </label>
              <input
                type="number"
                min="0"
                value={localData.followers_count || ''}
                onChange={(e) => setLocalData({ ...localData, followers_count: e.target.value ? parseInt(e.target.value) : undefined })}
                className="w-full px-4 py-2.5 border rounded-lg"
                placeholder="Ví dụ: 100000"
              />
            </div>
            <div>
              <label className="block text-sm font-medium text-[#374151] mb-2">
                Lượt xem trung bình
              </label>
              <input
                type="number"
                min="0"
                value={localData.avg_views || ''}
                onChange={(e) => setLocalData({ ...localData, avg_views: e.target.value ? parseInt(e.target.value) : undefined })}
                className="w-full px-4 py-2.5 border rounded-lg"
                placeholder="Ví dụ: 50000"
              />
            </div>
            <div>
              <label className="block text-sm font-medium text-[#374151] mb-2">
                Tỷ lệ tương tác (%)
              </label>
              <input
                type="number"
                min="0"
                max="100"
                step="0.1"
                value={localData.engagement_rate || ''}
                onChange={(e) => setLocalData({ ...localData, engagement_rate: e.target.value ? parseFloat(e.target.value) : undefined })}
                className="w-full px-4 py-2.5 border rounded-lg"
                placeholder="Ví dụ: 3.5"
              />
            </div>
            <div>
              <label className="block text-sm font-medium text-[#374151] mb-2">
                Danh mục nội dung
              </label>
              <div className="grid grid-cols-2 gap-2">
                {categories.map((category) => (
                  <button
                    key={category}
                    type="button"
                    onClick={() => toggleCategory(category)}
                    className={`px-4 py-2 rounded-lg border text-sm ${
                      localData.content_categories?.includes(category)
                        ? 'border-[#6366F1] bg-[#6366F1]/10 text-[#6366F1]'
                        : 'border-gray-300 hover:border-gray-400'
                    }`}
                  >
                    {category}
                  </button>
                ))}
              </div>
            </div>
          </>
        ) : (
          <>
            <div>
              <label className="block text-sm font-medium text-[#374151] mb-2">
                Quy mô công ty *
              </label>
              <select
                value={localData.company_size}
                onChange={(e) => setLocalData({ ...localData, company_size: e.target.value })}
                className="w-full px-4 py-2.5 border rounded-lg"
                required
              >
                <option value="">Chọn quy mô</option>
                <option value="startup">Startup (1-10 nhân viên)</option>
                <option value="small">Nhỏ (11-50 nhân viên)</option>
                <option value="medium">Vừa (51-200 nhân viên)</option>
                <option value="large">Lớn (201-1000 nhân viên)</option>
                <option value="enterprise">Doanh nghiệp (1000+ nhân viên)</option>
              </select>
            </div>
            <div>
              <label className="block text-sm font-medium text-[#374151] mb-2">
                Ngân sách marketing hàng tháng (USD)
              </label>
              <input
                type="number"
                min="0"
                value={localData.monthly_marketing_budget || ''}
                onChange={(e) => setLocalData({ ...localData, monthly_marketing_budget: e.target.value ? parseInt(e.target.value) : undefined })}
                className="w-full px-4 py-2.5 border rounded-lg"
                placeholder="Ví dụ: 5000"
              />
            </div>
            <div>
              <label className="block text-sm font-medium text-[#374151] mb-2">
                Nền tảng mục tiêu *
              </label>
              <div className="grid grid-cols-2 gap-2">
                {platforms.map((platform) => (
                  <button
                    key={platform}
                    type="button"
                    onClick={() => togglePlatform(platform, 'target')}
                    className={`px-4 py-2 rounded-lg border text-sm ${
                      localData.target_platforms?.includes(platform)
                        ? 'border-[#6366F1] bg-[#6366F1]/10 text-[#6366F1]'
                        : 'border-gray-300 hover:border-gray-400'
                    }`}
                  >
                    {platform}
                  </button>
                ))}
              </div>
            </div>
          </>
        )}

        <button
          type="submit"
          disabled={loading}
          className="w-full px-6 py-2.5 rounded-xl font-medium text-white bg-gradient-to-r from-[#6366F1] to-[#EC4899] disabled:opacity-50"
        >
          {loading ? 'Đang lưu...' : 'Tiếp tục'}
        </button>
      </div>
    </form>
  )
}

// Step 4: Collaboration Intent
function Step4Collaboration({
  role,
  formData,
  onSave,
  loading,
}: {
  role: 'creator' | 'brand'
  formData: OnboardingData
  onSave: (data: Partial<OnboardingData>) => void
  loading: boolean
}) {
  const [localData, setLocalData] = useState({
    collaboration_expectation: formData.collaboration_expectation || '',
    collaboration_goal: formData.collaboration_goal || '',
  })

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault()
    if (role === 'creator') {
      onSave({ collaboration_expectation: localData.collaboration_expectation })
    } else {
      onSave({ collaboration_goal: localData.collaboration_goal })
    }
  }

  return (
    <form onSubmit={handleSubmit}>
      <h1 className="text-3xl font-semibold tracking-tight mb-4">
        Mục tiêu hợp tác
      </h1>
      <p className="text-[#6B7280] mb-8">
        {role === 'creator' ? 'Bạn mong đợi gì từ các hợp tác?' : 'Mục tiêu hợp tác của thương hiệu là gì?'}
      </p>

      <div className="space-y-4">
        <div>
          <label className="block text-sm font-medium text-[#374151] mb-2">
            {role === 'creator' ? 'Kỳ vọng hợp tác *' : 'Mục tiêu hợp tác *'}
          </label>
          <textarea
            value={role === 'creator' ? localData.collaboration_expectation : localData.collaboration_goal}
            onChange={(e) =>
              role === 'creator'
                ? setLocalData({ ...localData, collaboration_expectation: e.target.value })
                : setLocalData({ ...localData, collaboration_goal: e.target.value })
            }
            rows={5}
            className="w-full px-4 py-2.5 border rounded-lg"
            placeholder={role === 'creator' ? 'Mô tả kỳ vọng của bạn về các hợp tác...' : 'Mô tả mục tiêu hợp tác của thương hiệu...'}
            required
          />
        </div>

        <button
          type="submit"
          disabled={loading}
          className="w-full px-6 py-2.5 rounded-xl font-medium text-white bg-gradient-to-r from-[#6366F1] to-[#EC4899] disabled:opacity-50"
        >
          {loading ? 'Đang lưu...' : 'Tiếp tục'}
        </button>
      </div>
    </form>
  )
}

// Step 5: Finalize
function Step5Finalize({
  role,
  formData,
  onComplete,
  loading,
}: {
  role: 'creator' | 'brand'
  formData: OnboardingData
  onComplete: () => void
  loading: boolean
}) {
  return (
    <div>
      <h1 className="text-3xl font-semibold tracking-tight mb-4">
        Hoàn tất thiết lập
      </h1>
      <p className="text-[#6B7280] mb-8">
        Bạn đã hoàn thành tất cả các bước thiết lập. Nhấn "Hoàn tất" để bắt đầu sử dụng ALINO.
      </p>

      <div className="bg-gray-50 rounded-lg p-4 mb-6">
        <h3 className="font-medium mb-2">Tóm tắt thông tin:</h3>
        <ul className="text-sm text-[#6B7280] space-y-1">
          {role === 'creator' && (
            <>
              <li>• Tên: {formData.display_name || 'Chưa có'}</li>
              <li>• Địa điểm: {formData.city && formData.country ? `${formData.city}, ${formData.country}` : 'Chưa có'}</li>
              <li>• Nền tảng: {formData.creator_platforms?.length || 0} nền tảng</li>
            </>
          )}
          {role === 'brand' && (
            <>
              <li>• Thương hiệu: {formData.brand_name || 'Chưa có'}</li>
              <li>• Ngành: {formData.industry || 'Chưa có'}</li>
              <li>• Quy mô: {formData.company_size || 'Chưa có'}</li>
            </>
          )}
        </ul>
      </div>

      <button
        onClick={onComplete}
        disabled={loading}
        className="w-full px-6 py-2.5 rounded-xl font-medium text-white bg-gradient-to-r from-[#6366F1] to-[#EC4899] disabled:opacity-50"
      >
        {loading ? 'Đang xử lý...' : 'Hoàn tất'}
      </button>
    </div>
  )
}
</file>

<file path="src/pages/ProfilePage.tsx">
import { useState, useEffect } from 'react'
import { useAuth } from '../hooks/useAuth'
import { useProfile } from '../hooks/useProfile'
import { getSupabase } from '../lib/supabase'
import type { OnboardingData } from '../types/profile'

export default function ProfilePage() {
  const { session, isAuthenticated } = useAuth()
  const { profile, loading: profileLoading } = useProfile(session?.user?.id, isAuthenticated)
  const [loading, setLoading] = useState(false)
  const [success, setSuccess] = useState(false)
  const [error, setError] = useState('')
  const supabase = getSupabase()

  const onboardingData: OnboardingData = (profile?.onboarding_data && typeof profile.onboarding_data === 'object'
    ? profile.onboarding_data
    : {}) as OnboardingData

  // Form state - initialize from profile
  const [formData, setFormData] = useState<OnboardingData>({})

  useEffect(() => {
    if (profile?.onboarding_data) {
      setFormData(onboardingData)
    }
  }, [profile])

  if (profileLoading) {
    return (
      <div className="min-h-screen flex items-center justify-center pt-24">
        <div className="text-[#6B7280]">Đang tải...</div>
      </div>
    )
  }

  if (!profile) {
    return (
      <div className="min-h-screen flex items-center justify-center pt-24">
        <div className="text-[#6B7280]">Không tìm thấy hồ sơ</div>
      </div>
    )
  }

  const role = profile.role || 'creator'

  const handleSave = async () => {
    if (!session || !profile) return

    setLoading(true)
    setError('')
    setSuccess(false)

    try {
      // Update both structured fields and onboarding_data
      const updatedOnboardingData = {
        ...onboardingData,
        ...formData,
        updated_at: new Date().toISOString(),
      }

      const { error } = await supabase
        .from('profiles')
        .update({
          onboarding_data: updatedOnboardingData,
        })
        .eq('id', session.user.id)

      if (error) throw error

      setSuccess(true)
      setTimeout(() => setSuccess(false), 3000)
    } catch (err: any) {
      setError(err.message || 'Không thể cập nhật hồ sơ')
    } finally {
      setLoading(false)
    }
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-[#EEF1FF] via-[#F5F7FF] to-white py-20 px-6 pt-24">
      <div className="max-w-3xl mx-auto">
        <div className="bg-white/90 backdrop-blur-xl rounded-3xl p-8 md:p-10 shadow-xl border border-black/5">
          <h1 className="text-3xl font-semibold tracking-tight mb-8">Hồ sơ</h1>

          {error && (
            <div className="mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm">
              {error}
            </div>
          )}

          {success && (
            <div className="mb-4 p-3 bg-green-50 border border-green-200 rounded-lg text-green-700 text-sm">
              Đã cập nhật hồ sơ thành công!
            </div>
          )}

          <form onSubmit={(e) => { e.preventDefault(); handleSave(); }} className="space-y-6">
            {/* Basic Identity Section */}
            <div className="border-b pb-6">
              <h2 className="text-xl font-semibold mb-4">Thông tin cơ bản</h2>
              
              {role === 'creator' ? (
                <>
                  <div className="mb-4">
                    <label className="block text-sm font-medium text-[#374151] mb-2">
                      Tên hiển thị
                    </label>
                    <input
                      type="text"
                      value={formData.display_name || ''}
                      onChange={(e) => setFormData({ ...formData, display_name: e.target.value })}
                      className="w-full px-4 py-2.5 border rounded-lg"
                      placeholder="Nhập tên hiển thị"
                    />
                  </div>
                  <div className="mb-4">
                    <label className="block text-sm font-medium text-[#374151] mb-2">
                      Avatar URL
                    </label>
                    <input
                      type="url"
                      value={formData.avatar_url || ''}
                      onChange={(e) => setFormData({ ...formData, avatar_url: e.target.value })}
                      className="w-full px-4 py-2.5 border rounded-lg"
                      placeholder="https://..."
                    />
                  </div>
                  <div className="grid grid-cols-2 gap-4 mb-4">
                    <div>
                      <label className="block text-sm font-medium text-[#374151] mb-2">
                        Quốc gia
                      </label>
                      <input
                        type="text"
                        value={formData.country || ''}
                        onChange={(e) => setFormData({ ...formData, country: e.target.value })}
                        className="w-full px-4 py-2.5 border rounded-lg"
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-[#374151] mb-2">
                        Thành phố
                      </label>
                      <input
                        type="text"
                        value={formData.city || ''}
                        onChange={(e) => setFormData({ ...formData, city: e.target.value })}
                        className="w-full px-4 py-2.5 border rounded-lg"
                      />
                    </div>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-[#374151] mb-2">
                      Năm sinh
                    </label>
                    <input
                      type="number"
                      min="1950"
                      max={new Date().getFullYear()}
                      value={formData.birth_year || ''}
                      onChange={(e) => setFormData({ ...formData, birth_year: e.target.value ? parseInt(e.target.value) : undefined })}
                      className="w-full px-4 py-2.5 border rounded-lg"
                    />
                  </div>
                </>
              ) : (
                <>
                  <div className="mb-4">
                    <label className="block text-sm font-medium text-[#374151] mb-2">
                      Tên thương hiệu
                    </label>
                    <input
                      type="text"
                      value={formData.brand_name || ''}
                      onChange={(e) => setFormData({ ...formData, brand_name: e.target.value })}
                      className="w-full px-4 py-2.5 border rounded-lg"
                      placeholder="Nhập tên thương hiệu"
                    />
                  </div>
                  <div className="mb-4">
                    <label className="block text-sm font-medium text-[#374151] mb-2">
                      Ngành nghề
                    </label>
                    <input
                      type="text"
                      value={formData.industry || ''}
                      onChange={(e) => setFormData({ ...formData, industry: e.target.value })}
                      className="w-full px-4 py-2.5 border rounded-lg"
                    />
                  </div>
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-medium text-[#374151] mb-2">
                        Quốc gia
                      </label>
                      <input
                        type="text"
                        value={formData.country || ''}
                        onChange={(e) => setFormData({ ...formData, country: e.target.value })}
                        className="w-full px-4 py-2.5 border rounded-lg"
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-[#374151] mb-2">
                        Thành phố
                      </label>
                      <input
                        type="text"
                        value={formData.city || ''}
                        onChange={(e) => setFormData({ ...formData, city: e.target.value })}
                        className="w-full px-4 py-2.5 border rounded-lg"
                      />
                    </div>
                  </div>
                </>
              )}
            </div>

            {/* Business/Creator Metrics Section */}
            <div className="border-b pb-6">
              <h2 className="text-xl font-semibold mb-4">
                {role === 'creator' ? 'Thông tin Creator' : 'Thông tin Brand'}
              </h2>

              {role === 'creator' ? (
                <>
                  <div className="mb-4">
                    <label className="block text-sm font-medium text-[#374151] mb-2">
                      Nền tảng
                    </label>
                    <div className="flex flex-wrap gap-2">
                      {['TikTok', 'Instagram', 'YouTube', 'Facebook', 'Twitter', 'LinkedIn'].map((platform) => (
                        <button
                          key={platform}
                          type="button"
                          onClick={() => {
                            const current = formData.creator_platforms || []
                            const updated = current.includes(platform)
                              ? current.filter((p) => p !== platform)
                              : [...current, platform]
                            setFormData({ ...formData, creator_platforms: updated })
                          }}
                          className={`px-4 py-2 rounded-lg border text-sm ${
                            formData.creator_platforms?.includes(platform)
                              ? 'border-[#6366F1] bg-[#6366F1]/10 text-[#6366F1]'
                              : 'border-gray-300 hover:border-gray-400'
                          }`}
                        >
                          {platform}
                        </button>
                      ))}
                    </div>
                  </div>
                  <div className="grid grid-cols-2 gap-4 mb-4">
                    <div>
                      <label className="block text-sm font-medium text-[#374151] mb-2">
                        Số lượng người theo dõi
                      </label>
                      <input
                        type="number"
                        min="0"
                        value={formData.followers_count || ''}
                        onChange={(e) => setFormData({ ...formData, followers_count: e.target.value ? parseInt(e.target.value) : undefined })}
                        className="w-full px-4 py-2.5 border rounded-lg"
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-[#374151] mb-2">
                        Lượt xem trung bình
                      </label>
                      <input
                        type="number"
                        min="0"
                        value={formData.avg_views || ''}
                        onChange={(e) => setFormData({ ...formData, avg_views: e.target.value ? parseInt(e.target.value) : undefined })}
                        className="w-full px-4 py-2.5 border rounded-lg"
                      />
                    </div>
                  </div>
                  <div className="grid grid-cols-2 gap-4 mb-4">
                    <div>
                      <label className="block text-sm font-medium text-[#374151] mb-2">
                        Tỷ lệ tương tác (%)
                      </label>
                      <input
                        type="number"
                        min="0"
                        max="100"
                        step="0.1"
                        value={formData.engagement_rate || ''}
                        onChange={(e) => setFormData({ ...formData, engagement_rate: e.target.value ? parseFloat(e.target.value) : undefined })}
                        className="w-full px-4 py-2.5 border rounded-lg"
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-[#374151] mb-2">
                        Danh mục nội dung
                      </label>
                      <div className="flex flex-wrap gap-2">
                        {['Beauty', 'Fashion', 'Food', 'Travel', 'Tech', 'Fitness', 'Lifestyle', 'Education'].map((category) => (
                          <button
                            key={category}
                            type="button"
                            onClick={() => {
                              const current = formData.content_categories || []
                              const updated = current.includes(category)
                                ? current.filter((c) => c !== category)
                                : [...current, category]
                              setFormData({ ...formData, content_categories: updated })
                            }}
                            className={`px-3 py-1 rounded-lg border text-xs ${
                              formData.content_categories?.includes(category)
                                ? 'border-[#6366F1] bg-[#6366F1]/10 text-[#6366F1]'
                                : 'border-gray-300 hover:border-gray-400'
                            }`}
                          >
                            {category}
                          </button>
                        ))}
                      </div>
                    </div>
                  </div>
                </>
              ) : (
                <>
                  <div className="mb-4">
                    <label className="block text-sm font-medium text-[#374151] mb-2">
                      Quy mô công ty
                    </label>
                    <select
                      value={formData.company_size || ''}
                      onChange={(e) => setFormData({ ...formData, company_size: e.target.value })}
                      className="w-full px-4 py-2.5 border rounded-lg"
                    >
                      <option value="">Chọn quy mô</option>
                      <option value="startup">Startup (1-10 nhân viên)</option>
                      <option value="small">Nhỏ (11-50 nhân viên)</option>
                      <option value="medium">Vừa (51-200 nhân viên)</option>
                      <option value="large">Lớn (201-1000 nhân viên)</option>
                      <option value="enterprise">Doanh nghiệp (1000+ nhân viên)</option>
                    </select>
                  </div>
                  <div className="mb-4">
                    <label className="block text-sm font-medium text-[#374151] mb-2">
                      Ngân sách marketing hàng tháng (USD)
                    </label>
                    <input
                      type="number"
                      min="0"
                      value={formData.monthly_marketing_budget || ''}
                      onChange={(e) => setFormData({ ...formData, monthly_marketing_budget: e.target.value ? parseInt(e.target.value) : undefined })}
                      className="w-full px-4 py-2.5 border rounded-lg"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-[#374151] mb-2">
                      Nền tảng mục tiêu
                    </label>
                    <div className="flex flex-wrap gap-2">
                      {['TikTok', 'Instagram', 'YouTube', 'Facebook', 'Twitter', 'LinkedIn'].map((platform) => (
                        <button
                          key={platform}
                          type="button"
                          onClick={() => {
                            const current = formData.target_platforms || []
                            const updated = current.includes(platform)
                              ? current.filter((p) => p !== platform)
                              : [...current, platform]
                            setFormData({ ...formData, target_platforms: updated })
                          }}
                          className={`px-4 py-2 rounded-lg border text-sm ${
                            formData.target_platforms?.includes(platform)
                              ? 'border-[#6366F1] bg-[#6366F1]/10 text-[#6366F1]'
                              : 'border-gray-300 hover:border-gray-400'
                          }`}
                        >
                          {platform}
                        </button>
                      ))}
                    </div>
                  </div>
                </>
              )}
            </div>

            {/* Collaboration Intent Section */}
            <div className="pb-6">
              <h2 className="text-xl font-semibold mb-4">Mục tiêu hợp tác</h2>
              <div>
                <label className="block text-sm font-medium text-[#374151] mb-2">
                  {role === 'creator' ? 'Kỳ vọng hợp tác' : 'Mục tiêu hợp tác'}
                </label>
                <textarea
                  value={role === 'creator' ? (formData.collaboration_expectation || '') : (formData.collaboration_goal || '')}
                  onChange={(e) =>
                    role === 'creator'
                      ? setFormData({ ...formData, collaboration_expectation: e.target.value })
                      : setFormData({ ...formData, collaboration_goal: e.target.value })
                  }
                  rows={5}
                  className="w-full px-4 py-2.5 border rounded-lg"
                  placeholder={role === 'creator' ? 'Mô tả kỳ vọng của bạn về các hợp tác...' : 'Mô tả mục tiêu hợp tác của thương hiệu...'}
                />
              </div>
            </div>

            {/* Email (read-only) */}
            <div className="border-t pt-6">
              <label className="block text-sm font-medium text-[#374151] mb-2">
                Email
              </label>
              <input
                type="email"
                value={session?.user?.email || ''}
                disabled
                className="w-full px-4 py-2.5 border rounded-lg bg-gray-50 text-gray-500"
              />
            </div>

            <button
              type="submit"
              disabled={loading}
              className="w-full px-6 py-2.5 rounded-xl font-medium text-white bg-gradient-to-r from-[#6366F1] to-[#EC4899] disabled:opacity-50"
            >
              {loading ? 'Đang lưu...' : 'Lưu thay đổi'}
            </button>
          </form>
        </div>
      </div>
    </div>
  )
}
</file>

<file path="src/pages/RolePage.tsx">
import { useState } from 'react'
import { useNavigate } from 'react-router-dom'
import { useAuth } from '../hooks/useAuth'
import { getSupabase } from '../lib/supabase'

export default function RolePage() {
  const { session } = useAuth()
  const [loading, setLoading] = useState(false)
  const navigate = useNavigate()
  const supabase = getSupabase()

  const handleSelectRole = async (role: 'creator' | 'brand') => {
    if (!session) return

    setLoading(true)

    try {
      // Get existing onboarding_data
      const { data: existingProfile } = await supabase
        .from('profiles')
        .select('onboarding_data')
        .eq('id', session.user.id)
        .single()

      const existingData = (existingProfile?.onboarding_data as any) || {}

      // Update role and save role_selected_at timestamp in onboarding_data
      const { error } = await supabase
        .from('profiles')
        .update({
          role,
          onboarding_data: {
            ...existingData,
            role_selected_at: new Date().toISOString(),
          },
        })
        .eq('id', session.user.id)

      if (error) throw error

      // After success → navigate('/app')
      navigate('/app', { replace: true })
    } catch (err: any) {
      setLoading(false)
      alert(err.message || 'Có lỗi xảy ra khi chọn vai trò')
    }
  }

  return (
    <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-[#EEF1FF] via-[#F5F7FF] to-white py-20 px-6 pt-24">
      <div className="w-full max-w-4xl">
        <div className="text-center mb-12">
          <h1 className="text-4xl md:text-5xl font-semibold tracking-tight mb-4">
            Chọn vai trò của bạn
          </h1>
          <p className="text-lg text-[#6B7280] max-w-2xl mx-auto">
            Chọn vai trò phù hợp với cách bạn sử dụng ALINO. Bạn có thể thay đổi sau.
          </p>
        </div>

        <div className="grid md:grid-cols-2 gap-6">
          <button
            onClick={() => handleSelectRole('creator')}
            disabled={loading}
            className="p-8 bg-white rounded-2xl border-2 border-gray-200 hover:border-[#6366F1] transition-colors text-left disabled:opacity-50"
          >
            <h3 className="text-2xl font-semibold mb-2">Creator</h3>
            <p className="text-[#6B7280]">
              Tôi là Creator muốn hợp tác với các Brand
            </p>
          </button>

          <button
            onClick={() => handleSelectRole('brand')}
            disabled={loading}
            className="p-8 bg-white rounded-2xl border-2 border-gray-200 hover:border-[#6366F1] transition-colors text-left disabled:opacity-50"
          >
            <h3 className="text-2xl font-semibold mb-2">Brand</h3>
            <p className="text-[#6B7280]">
              Tôi là Brand muốn hợp tác với các Creator
            </p>
          </button>
        </div>
      </div>
    </div>
  )
}
</file>

<file path="src/pages/SettingsPage.tsx">
import { useAuth } from '../hooks/useAuth'

export default function SettingsPage() {
  const { signOut } = useAuth()

  const handleChangePassword = async () => {
    // Coming soon
  }

  const handleChangeEmail = async () => {
    // Coming soon
  }

  const handleLogoutAll = async () => {
    // Coming soon
  }

  const handleDeleteAccount = async () => {
    // Coming soon
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-[#EEF1FF] via-[#F5F7FF] to-white py-20 px-6 pt-24">
      <div className="max-w-3xl mx-auto">
        <div className="bg-white/90 backdrop-blur-xl rounded-3xl p-8 md:p-10 shadow-xl border border-black/5">
          <h1 className="text-3xl font-semibold tracking-tight mb-8">Cài đặt</h1>

          <div className="space-y-6">

            <div className="border-b border-gray-200 pb-6">
              <h2 className="text-lg font-semibold text-[#374151] mb-2">Đổi mật khẩu</h2>
              <p className="text-sm text-[#6B7280] mb-4">
                Cập nhật mật khẩu của bạn để bảo vệ tài khoản
              </p>
              <button
                onClick={handleChangePassword}
                disabled
                className="px-6 py-2.5 rounded-xl font-medium text-[#6366F1] border border-[#6366F1] opacity-50 cursor-not-allowed"
              >
                Coming soon
              </button>
            </div>

            <div className="border-b border-gray-200 pb-6">
              <h2 className="text-lg font-semibold text-[#374151] mb-2">Đổi email</h2>
              <p className="text-sm text-[#6B7280] mb-4">
                Cập nhật địa chỉ email của bạn
              </p>
              <button
                onClick={handleChangeEmail}
                disabled
                className="px-6 py-2.5 rounded-xl font-medium text-[#6366F1] border border-[#6366F1] opacity-50 cursor-not-allowed"
              >
                Coming soon
              </button>
            </div>

            <div className="border-b border-gray-200 pb-6">
              <h2 className="text-lg font-semibold text-[#374151] mb-2">Đăng xuất tất cả thiết bị</h2>
              <p className="text-sm text-[#6B7280] mb-4">
                Đăng xuất khỏi tất cả các thiết bị và trình duyệt
              </p>
              <button
                onClick={handleLogoutAll}
                disabled
                className="px-6 py-2.5 rounded-xl font-medium text-[#6366F1] border border-[#6366F1] opacity-50 cursor-not-allowed"
              >
                Coming soon
              </button>
            </div>

            <div className="pb-6">
              <h2 className="text-lg font-semibold text-red-600 mb-2">Xóa tài khoản</h2>
              <p className="text-sm text-[#6B7280] mb-4">
                Xóa vĩnh viễn tài khoản và tất cả dữ liệu của bạn
              </p>
              <button
                onClick={handleDeleteAccount}
                disabled
                className="px-6 py-2.5 rounded-xl font-medium text-red-600 border border-red-600 opacity-50 cursor-not-allowed"
              >
                Coming soon
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  )
}
</file>

<file path="src/pages/SignupPage.tsx">
import { useState } from 'react'
import { Link, useNavigate } from 'react-router-dom'
import { getSupabase } from '../lib/supabase'

export default function SignupPage() {
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [confirmPassword, setConfirmPassword] = useState('')
  const [error, setError] = useState('')
  const [loading, setLoading] = useState(false)
  const navigate = useNavigate()
  const supabase = getSupabase()

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault()
    setError('')

    if (password !== confirmPassword) {
      setError('Mật khẩu xác nhận không khớp')
      return
    }

    if (password.length < 6) {
      setError('Mật khẩu phải có ít nhất 6 ký tự')
      return
    }

    setLoading(true)

    try {
      const { error } = await supabase.auth.signUp({
        email,
        password,
        options: {
          emailRedirectTo: `${window.location.origin}/verify-email`,
        },
      })

      if (error) {
        setError(error.message || 'Đăng ký thất bại')
        setLoading(false)
        return
      }

      navigate('/?signup=success', { replace: true })
    } catch (err) {
      setError('Có lỗi xảy ra')
      setLoading(false)
    }
  }

  const handleGoogleSignup = async () => {
    const { data, error } = await supabase.auth.signInWithOAuth({
      provider: 'google',
      options: {
        redirectTo: `${window.location.origin}/app`,
      },
    })

    if (error) {
      setError(error.message)
      return
    }

    if (data.url) {
      window.location.href = data.url
    }
  }

  return (
    <div className="min-h-screen flex items-center justify-center bg-[#F9FAFB] px-6 pt-16">
      <div className="w-full max-w-6xl bg-white rounded-3xl shadow-xl overflow-hidden flex">
        <div className="hidden lg:flex w-[45%] bg-gradient-to-br from-[#6366F1]/20 via-[#7C3AED]/15 to-[#EC4899]/20">
          <div className="flex flex-col px-12 pt-12 items-center">
            <img
              src="/logo/logo.png"
              alt="ALINO"
              className="w-40 h-40 mb-6"
            />
            <h1 className="text-3xl font-semibold text-[#1F2937] mb-3">
              Tạo tài khoản mới
            </h1>
            <p className="text-[#6B7280] leading-relaxed">
              Bắt đầu hành trình hợp tác với Alino
            </p>
          </div>
        </div>

        <div className="w-full lg:w-[55%] px-10 py-8 flex items-center justify-center">
          <div className="w-full max-w-sm">
            <h2 className="text-2xl font-semibold mb-2">Đăng ký</h2>
            <p className="text-sm text-[#6B7280] mb-6">
              Tạo tài khoản mới để bắt đầu
            </p>

            {error && (
              <div className="mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm">
                {error}
              </div>
            )}

            <form onSubmit={handleSubmit} className="space-y-4">
              <input
                type="email"
                placeholder="Email"
                value={email}
                onChange={(e) => setEmail(e.target.value)}
                className="w-full px-3 py-2.5 border rounded-lg"
                required
              />

              <input
                type="password"
                placeholder="Mật khẩu"
                value={password}
                onChange={(e) => setPassword(e.target.value)}
                className="w-full px-3 py-2.5 border rounded-lg"
                required
              />

              <input
                type="password"
                placeholder="Xác nhận mật khẩu"
                value={confirmPassword}
                onChange={(e) => setConfirmPassword(e.target.value)}
                className="w-full px-3 py-2.5 border rounded-lg"
                required
              />

              <button
                type="submit"
                disabled={loading}
                className="w-full py-2.5 rounded-lg text-white font-medium bg-gradient-to-r from-[#6366F1] to-[#EC4899] disabled:opacity-50"
              >
                {loading ? 'Đang tạo tài khoản...' : 'Đăng ký'}
              </button>
            </form>

            <div className="my-5 text-center text-xs text-[#9CA3AF]">HOẶC</div>

            <button
              onClick={handleGoogleSignup}
              className="w-full py-2.5 border rounded-lg text-sm hover:bg-gray-50 flex items-center justify-center gap-3"
            >
              <svg className="w-5 h-5" viewBox="0 0 24 24">
                <path
                  fill="#4285F4"
                  d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"
                />
                <path
                  fill="#34A853"
                  d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"
                />
                <path
                  fill="#FBBC05"
                  d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"
                />
                <path
                  fill="#EA4335"
                  d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"
                />
              </svg>
              Đăng ký với Google
            </button>

            <p className="mt-6 text-center text-sm text-[#6B7280]">
              Đã có tài khoản?{' '}
              <Link to="/login" className="text-[#6366F1] font-medium">
                Đăng nhập
              </Link>
            </p>
          </div>
        </div>
      </div>
    </div>
  )
}
</file>

<file path="src/pages/VerifyEmailPage.tsx">
import { useEffect } from 'react'
import { Link } from 'react-router-dom'
import { getSupabase } from '../lib/supabase'

export default function VerifyEmailPage() {
  const supabase = getSupabase()

  useEffect(() => {
    // Sign out any existing session to prevent auto-login
    supabase.auth.signOut()
  }, [])

  return (
    <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-[#EEF1FF] via-[#F5F7FF] to-white py-20 px-6 pt-24">
      <div className="w-full max-w-md">
        <div className="bg-white/90 backdrop-blur-xl rounded-3xl p-8 shadow-xl border border-black/5 text-center">
          <div className="w-16 h-16 mx-auto mb-6 rounded-full bg-gradient-to-r from-[#6366F1] to-[#EC4899] flex items-center justify-center">
            <svg className="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>

          <h1 className="text-3xl font-semibold tracking-tight mb-4">
            Xác thực thành công
          </h1>

          <p className="text-[#6B7280] mb-8 leading-relaxed">
            Tài khoản đã được xác thực. Vui lòng đăng nhập để tiếp tục.
          </p>

          <Link
            to="/login"
            className="inline-block px-6 py-3 rounded-xl font-semibold text-white bg-gradient-to-r from-[#6366F1] to-[#EC4899] hover:scale-105 transition-transform shadow-lg shadow-[#6366F1]/25"
          >
            Đăng nhập
          </Link>
        </div>
      </div>
    </div>
  )
}
</file>

<file path="src/router.tsx">
import { Routes, Route, Navigate } from 'react-router-dom'
import { useAuth } from './hooks/useAuth'
import { useProfile } from './hooks/useProfile'
import LandingPage from './pages/LandingPage'
import LoginPage from './pages/LoginPage'
import SignupPage from './pages/SignupPage'
import VerifyEmailPage from './pages/VerifyEmailPage'
import AppGate from './pages/AppGate'
import RolePage from './pages/RolePage'
import OnboardingPage from './pages/OnboardingPage'
import CreatorDashboard from './pages/CreatorDashboard'
import BrandDashboard from './pages/BrandDashboard'
import ProfilePage from './pages/ProfilePage'
import SettingsPage from './pages/SettingsPage'

function ProtectedRoute({ children }: { children: React.ReactNode }) {
  const { session, loading } = useAuth()

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-[#6B7280]">Đang tải...</div>
      </div>
    )
  }

  if (!session) {
    return <Navigate to="/login" replace />
  }

  return <>{children}</>
}

function PublicRoute({ children }: { children: React.ReactNode }) {
  const { session, loading } = useAuth()

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-[#6B7280]">Đang tải...</div>
      </div>
    )
  }

  if (session) {
    return <Navigate to="/app" replace />
  }

  return <>{children}</>
}

export function Router() {
  return (
    <Routes>
      <Route path="/" element={<LandingPage />} />
      
      <Route
        path="/login"
        element={
          <PublicRoute>
            <LoginPage />
          </PublicRoute>
        }
      />
      
      <Route
        path="/signup"
        element={
          <PublicRoute>
            <SignupPage />
          </PublicRoute>
        }
      />
      
      <Route path="/verify-email" element={<VerifyEmailPage />} />

      <Route path="/app" element={<AppGate />} />

      <Route
        path="/role"
        element={
          <ProtectedRoute>
            <RolePage />
          </ProtectedRoute>
        }
      />

      <Route
        path="/onboarding"
        element={
          <ProtectedRoute>
            <OnboardingPage />
          </ProtectedRoute>
        }
      />

      <Route
        path="/dashboard"
        element={<DashboardEntry />}
      />

      <Route
        path="/projects"
        element={<DashboardEntry />}
      />

      <Route
        path="/profile"
        element={
          <ProtectedRoute>
            <ProfilePage />
          </ProtectedRoute>
        }
      />

      <Route
        path="/settings"
        element={
          <ProtectedRoute>
            <SettingsPage />
          </ProtectedRoute>
        }
      />

      <Route path="*" element={<Navigate to="/" replace />} />
    </Routes>
  )
}

function DashboardEntry() {
  const { session, loading, user, isAuthenticated } = useAuth()
  const { profile } = useProfile(user?.id, isAuthenticated)

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-[#6B7280]">Đang tải...</div>
      </div>
    )
  }

  // Minimal session guard
  if (!session) {
    return <Navigate to="/" replace />
  }

  if (!profile) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-[#6B7280]">Đang tải...</div>
      </div>
    )
  }

  if (profile.role === 'creator') {
    return <CreatorDashboard />
  }

  return <BrandDashboard />
}
</file>

<file path="supabase/migrations/001_create_profiles.sql">
-- Create profiles table
CREATE TABLE IF NOT EXISTS public.profiles (
  id UUID PRIMARY KEY REFERENCES auth.users(id) ON DELETE CASCADE,
  role TEXT CHECK (role IN ('creator', 'brand')),
  onboarding_completed BOOLEAN DEFAULT FALSE,
  onboarding_data JSONB DEFAULT '{}'::jsonb,
  
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Enable RLS
ALTER TABLE public.profiles ENABLE ROW LEVEL SECURITY;

-- RLS Policy: Users can read their own profile
CREATE POLICY "Users can read their own profile"
  ON public.profiles
  FOR SELECT
  USING (auth.uid() = id);

-- RLS Policy: Users can update their own profile
CREATE POLICY "Users can update their own profile"
  ON public.profiles
  FOR UPDATE
  USING (auth.uid() = id)
  WITH CHECK (auth.uid() = id);

-- RLS Policy: Users can insert their own profile
CREATE POLICY "Users can insert their own profile"
  ON public.profiles
  FOR INSERT
  WITH CHECK (auth.uid() = id);

-- RLS Policy: Admin users (email ends with @alino.net) can read all profiles
CREATE POLICY "Admin users can read all profiles"
  ON public.profiles
  FOR SELECT
  USING (
    EXISTS (
      SELECT 1 FROM auth.users
      WHERE auth.users.id = auth.uid()
      AND auth.users.email LIKE '%@alino.net'
    )
  );

-- RLS Policy: Admin users can update all profiles
CREATE POLICY "Admin users can update all profiles"
  ON public.profiles
  FOR UPDATE
  USING (
    EXISTS (
      SELECT 1 FROM auth.users
      WHERE auth.users.id = auth.uid()
      AND auth.users.email LIKE '%@alino.net'
    )
  )
  WITH CHECK (
    EXISTS (
      SELECT 1 FROM auth.users
      WHERE auth.users.id = auth.uid()
      AND auth.users.email LIKE '%@alino.net'
    )
  );

-- Function to automatically update updated_at timestamp
CREATE OR REPLACE FUNCTION public.handle_updated_at()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- Trigger to update updated_at on profile updates
CREATE TRIGGER set_updated_at
  BEFORE UPDATE ON public.profiles
  FOR EACH ROW
  EXECUTE FUNCTION public.handle_updated_at();

-- Create index on role for faster queries
CREATE INDEX IF NOT EXISTS idx_profiles_role ON public.profiles(role);

-- Create index on onboarding_completed for faster queries
CREATE INDEX IF NOT EXISTS idx_profiles_onboarding_completed ON public.profiles(onboarding_completed);
</file>

<file path="MIGRATION_GUIDE.md">
# Migration Guide: Next.js to Vite + React

## Overview
This project has been migrated from Next.js App Router to Vite + React for simplicity and predictability.

## Key Changes

### 1. Project Structure
- **Old**: `app/` directory with Next.js App Router
- **New**: `src/` directory with standard React structure

### 2. Routing
- **Old**: Next.js file-based routing (`app/page.tsx`, `app/login/page.tsx`)
- **New**: React Router with `src/router.tsx`

### 3. Authentication
- **Old**: Server-side auth with cookies, API routes
- **New**: Client-side only with Supabase client, localStorage persistence

### 4. No More Server Components
- All components are now client-side React components
- No SSR, no hydration issues

## Setup Instructions

1. **Install dependencies:**
```bash
npm install
```

2. **Create `.env` file:**
```env
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

3. **Start development server:**
```bash
npm run dev
```

## File Mapping

| Next.js | Vite + React |
|---------|--------------|
| `app/page.tsx` | `src/pages/LandingPage.tsx` |
| `app/login/page.tsx` | `src/pages/LoginPage.tsx` |
| `app/signup/page.tsx` | `src/pages/SignupPage.tsx` |
| `app/creator/page.tsx` | `src/pages/CreatorDashboard.tsx` |
| `app/brand/page.tsx` | `src/pages/BrandDashboard.tsx` |
| `app/profile/page.tsx` | `src/pages/ProfilePage.tsx` |
| `app/settings/page.tsx` | `src/pages/SettingsPage.tsx` |
| `app/components/layout/Header.tsx` | `src/components/layout/Header.tsx` |
| `lib/hooks/useAuth.ts` | `src/hooks/useAuth.ts` |
| `lib/supabase-client.ts` | `src/lib/supabase.ts` |

## Removed Concepts

- ❌ Server Components
- ❌ Route Handlers (`app/api/`)
- ❌ Server-side auth guards
- ❌ AuthGate component
- ❌ Middleware
- ❌ `layout.tsx`
- ❌ `next/image` (use `<img>`)
- ❌ `next/link` (use React Router `Link`)

## What Works Now

✅ Simple client-side routing
✅ Supabase auth with localStorage
✅ No navigation blocking
✅ Predictable behavior
✅ Easy to understand and modify

## Next Steps

1. Copy `vite-package.json` to `package.json`
2. Copy `vite.config.ts` to root
3. Copy `vite-tailwind.config.js` to `tailwind.config.js`
4. Copy `vite-postcss.config.js` to `postcss.config.js`
5. Copy `vite-tsconfig.json` to `tsconfig.json`
6. Copy `vite-tsconfig.node.json` to `tsconfig.node.json`
7. Move `src/` directory to root
8. Move `index.html` to root
9. Update environment variables to use `VITE_` prefix
10. Run `npm install` and `npm run dev`
</file>

<file path="postcss.config.cjs">
module.exports = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}
</file>

<file path="PROFILES_IMPLEMENTATION.md">
# Profiles Implementation Guide

## Overview
This implementation creates `public.profiles` as the single source of truth for user data, with proper RLS policies for admin vs user access control.

## SQL Migration

Run the SQL migration file to create the profiles table and RLS policies:

**File:** `supabase/migrations/001_create_profiles.sql`

Execute this SQL in your Supabase SQL Editor or via Supabase CLI.

## Key Features

1. **Profiles Table**: Stores all user data including role, onboarding completion status, and all onboarding survey data
2. **RLS Policies**:
   - Users can read/update their own profile
   - Admin users (email ends with `@alino.net`) can read/update all profiles
3. **Data Flow**:
   - Role selection → Creates/updates profile in `profiles` table
   - Onboarding completion → Updates profile with survey data
   - Dashboards → Read from `profiles` table (via `/api/profile`)

## API Endpoints

### POST `/api/auth/role`
- Creates/updates profile with role
- Sets `onboarding_completed = false`

### POST `/api/auth/onboarding`
- Updates profile with onboarding survey data
- Sets `onboarding_completed = true`

### GET `/api/profile`
- Users: Returns their own profile
- Admins: Returns all profiles

## Admin Detection

Admin users are identified by email ending with `@alino.net` (checked in `lib/supabase-helpers.ts`).

## Notes

- `user_metadata` is still updated for AuthGate compatibility (role, onboardingCompleted flags)
- `profiles` table is the source of truth for all user data
- RLS policies enforce data access restrictions automatically
</file>

<file path="README_VITE.md">
# Vite + React Migration Complete

## Quick Start

1. **Install dependencies:**
```bash
npm install
```

2. **Set up environment variables:**
Create `.env` file:
```env
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

3. **Start development:**
```bash
npm run dev
```

## Project Structure

```
src/
  ├── main.tsx              # Entry point
  ├── App.tsx               # Root component with Router
  ├── router.tsx            # React Router configuration
  ├── index.css             # Global styles (Tailwind)
  ├── components/
  │   └── layout/
  │       ├── Header.tsx    # Navigation header
  │       ├── UserMenu.tsx  # User dropdown menu
  │       └── Footer.tsx    # Footer component
  ├── pages/
  │   ├── LandingPage.tsx
  │   ├── LoginPage.tsx
  │   ├── SignupPage.tsx
  │   ├── VerifyEmailPage.tsx
  │   ├── RolePage.tsx
  │   ├── OnboardingPage.tsx
  │   ├── CreatorDashboard.tsx
  │   ├── BrandDashboard.tsx
  │   ├── ProfilePage.tsx
  │   └── SettingsPage.tsx
  ├── hooks/
  │   └── useAuth.ts        # Auth hook (client-side only)
  └── lib/
      └── supabase.ts       # Supabase client setup
```

## Key Features

✅ **Simple Client-Side Auth**
- Supabase client with localStorage persistence
- No server-side auth checks
- Session persists across page refreshes

✅ **React Router**
- Clean, predictable routing
- Protected routes with simple guards
- No navigation blocking

✅ **No SSR Complexity**
- All components are client-side
- No hydration issues
- Easy to understand and modify

## Migration Notes

- All Next.js concepts removed (App Router, Server Components, Route Handlers)
- Auth is now 100% client-side
- Navigation always works - no redirect loops
- Profile/role checks happen in router, not on every navigation

## Next Steps

1. Copy all `vite-*` files to root (remove `vite-` prefix)
2. Move `src/` directory to root
3. Move `index.html` to root
4. Update environment variables
5. Run `npm install` and `npm run dev`
</file>

<file path="TECHNICAL_SUMMARY.md">
# ALINO APP - TECHNICAL SUMMARY

> **Tài liệu handover & review**  
> **Ngày cập nhật:** 26/12/2025  
> **Version:** Phase 1-3 Complete

---

## 1. PROJECT OVERVIEW

### Mục tiêu
Nền tảng kết nối **Creators** và **Brands** để tạo tăng trưởng thông qua Creator Marketing.

- **Creator**: Tạo profile chuyên nghiệp, quản lý booking, hợp đồng, nhận thanh toán
- **Brand**: Tìm creator phù hợp, quản lý campaign, tracking, báo cáo

### Tech Stack
- **Frontend**: React 18.2 + TypeScript
- **Build Tool**: Vite 5.0
- **Styling**: TailwindCSS 3.4
- **Routing**: React Router DOM v7.11
- **Backend**: Supabase (Auth + Database + Storage)
- **State**: React Query (profile data) + React Context (auth)
- **Deployment**: Vercel

### Bundle Size
- **Total**: 645KB (gzip: 184KB)
- **Acceptable** cho SaaS app với nhiều tính năng

---

## 2. KIẾN TRÚC HIỆN TẠI

### Folder Structure
```
src/
├── app/providers/         # Context providers (Auth)
├── components/            # Shared UI (Layout, Skeleton, Toast, ErrorBoundary)
├── features/              # Feature modules (auth, dashboard, landing, onboarding)
├── lib/                   # Utils (supabase, queries, errors, env)
├── pages/                 # Route entry points
└── shared/                # Types, routes, constants, enums
```

### Data Flow
```
Component → React Query (useProfile) → Supabase Client → PostgreSQL
                ↓ (cache 5min)
            Query Cache → Auto sync khi update
```

### Auth Flow
```
Login/Signup → Supabase Auth → Session → AuthProvider → RequireAuth → Pages
                                              ↓
                                        AppGate (check role + onboarding)
                                              ↓
                                    Dashboard (Creator/Brand)
```

### Core Components
- **ErrorBoundary**: Bắt lỗi toàn app, hiển thị fallback UI
- **AuthProvider**: Quản lý session/user, subscribe auth changes
- **RequireAuth**: Guard cho protected routes, check email verification
- **AppGate**: Logic routing theo role + onboarding status
- **Onboarding**: Chia thành CreatorOnboarding + BrandOnboarding
- **Profile**: Dynamic render theo role (Creator/Brand)

---

## 3. QUYẾT ĐỊNH KỸ THUẬT QUAN TRỌNG

### ✅ Phase 1: Critical Fixes

#### 1.1. Refactor Onboarding (657 lines → 3 files)
**Lý do**: Component quá lớn, khó maintain  
**Giải pháp**:
- `Onboarding.tsx`: Router (fetch + route theo role)
- `CreatorOnboarding.tsx`: Form riêng cho creator
- `BrandOnboarding.tsx`: Form riêng cho brand

**Trade-off**: Có duplicate code (avatar, validation) nhưng dễ extend độc lập.

#### 1.2. ErrorBoundary
**Lý do**: App crash → white screen, UX tệ  
**Giải pháp**: Class component bọc toàn app, catch errors, show fallback UI

#### 1.3. Fix Race Conditions
**Vấn đề**: Navigate trước khi data ready → query null  
**Giải pháp**:
- AuthProvider: Check `mounted` trong callbacks
- AuthCallback/AppGate: Thêm delay 100ms sau upsert trước khi navigate
- **Trade-off**: Delay nhỏ (100ms) nhưng đảm bảo data consistency

---

### ✅ Phase 2: React Query

#### 2.1. Tại sao dùng React Query?
**Vấn đề**:
- Profile fetch nhiều lần (AppGate, Profile, Settings)
- Không có cache → lãng phí bandwidth
- Update profile → phải refetch thủ công

**Giải pháp**:
- `useProfile()`: Fetch + cache 5 phút
- `useUpdateProfile()`: Mutation + auto invalidate cache
- **Scope**: CHỈ profile data (không migrate toàn bộ)

**Lợi ích**:
- Giảm API calls ~70%
- Data sync tự động across components
- Loading/error states nhất quán

#### 2.2. Tại sao không dùng Redux/Zustand?
- **Profile data**: Server state → React Query phù hợp
- **Auth state**: Simple context đủ (session + user)
- **Không có complex client state** cần global store

---

### ✅ Phase 3: Code Quality

#### 3.1. Enums thay Magic Strings
**Trước**:
```tsx
const checks = [['fullName', !fullName.trim()], ...];
if (profile.role === 'creator') { ... }
```

**Sau**:
```tsx
const checks = [[ProfileField.FULL_NAME, !fullName.trim()], ...];
if (profile.role === Role.CREATOR) { ... }
```

**Lợi ích**: Type safety, autocomplete, không typo

#### 3.2. Structured Error Handling
**Trước**: `catch (err) { setError('Lỗi...') }`  
**Sau**: `catch (err) { setError(handleError(new AppError(...))) }`

**Lợi ích**:
- Error codes cho debugging
- User-friendly messages (Tiếng Việt)
- Severity levels (info/warning/error/critical)
- Dễ tích hợp Sentry sau này

#### 3.3. Loading Skeletons
**Trước**: Spinner hoặc text "Đang tải..."  
**Sau**: Skeleton UI (giống content layout)

**Lợi ích**: Professional UX, perceived performance tốt hơn

---

## 4. NHỮNG THỨ CỐ TÌNH CHƯA LÀM

### ❌ React Hook Form + Zod
**Lý do**: 
- Form hiện tại đơn giản, validation thủ công đủ
- Thêm dependency ~50KB, chưa cần thiết
- **Khi nào cần**: Khi có form phức tạp (dynamic fields, nested validation)

### ❌ Form Validation Refactor
**Lý do**:
- Logic validation đang work, không có bug
- Refactor = high risk, low reward
- **Khi nào cần**: Khi scale form (thêm 10+ fields mới)

### ❌ Dashboard Implementation
**Lý do**: 
- Chỉ placeholder, chờ business confirm features
- Không rõ data model, workflow cụ thể
- **Đúng quyết định**: Không build blind

### ❌ Unit Tests
**Lý do**:
- MVP phase, focus stability trước
- Manual test đủ cho core flows
- **Khi nào cần**: Sau khi có 2-3 features nữa, setup CI/CD

### ❌ i18n (Internationalization)
**Lý do**:
- Target thị trường Việt Nam
- Thêm i18n = overhead, chậm development
- **Khi nào cần**: Khi expand sang thị trường nước ngoài

### ❌ Analytics/Monitoring
**Lý do**: Chưa có traffic, chưa cần optimize
- **Khi nào cần**: Sau khi launch public (100+ users)

---

## 5. HƯỚNG MỞ RỘNG TIẾP THEO

### 🎯 Business Priority

#### Ngắn hạn (1-2 tháng)
1. **Dashboard thực tế**
   - Creator: Deal management, content calendar, payment tracking
   - Brand: Campaign creation, creator discovery, analytics

2. **Booking Flow**
   - Brand gửi booking request
   - Creator accept/reject
   - Contract generation

3. **Payment Integration**
   - Escrow system
   - Invoice management
   - Payment history

#### Trung hạn (3-6 tháng)
4. **Messaging System** (Creator ↔ Brand communication)
5. **Content Review Flow** (upload → feedback → approve)
6. **Analytics Dashboard** (campaign performance, ROI)

#### Dài hạn (6-12 tháng)
7. **Marketplace** (public creator profiles, search/filter)
8. **AI Matching** (recommend creator based on brand needs)
9. **Mobile App** (React Native hoặc PWA)

---

### 🛠️ Tech Improvements

#### High Priority
1. **Unit Tests cho Critical Flows**
   - Auth (login, signup, password reset)
   - Onboarding (validation, data save)
   - Profile (update, avatar upload)
   - **Tool**: Vitest + React Testing Library

2. **Bundle Optimization**
   - Code splitting (React.lazy + Suspense)
   - Dynamic imports cho landing sections
   - Target: 645KB → 400KB
   - **Tool**: Vite rollupOptions

3. **Error Monitoring**
   - Integrate Sentry
   - Track errors với context (user, page, action)
   - Alert cho critical errors

#### Medium Priority
4. **Performance Monitoring**
   - Web Vitals (LCP, FID, CLS)
   - Custom metrics (API latency, query cache hit rate)
   - **Tool**: Vercel Analytics hoặc Google Analytics

5. **CI/CD Pipeline**
   - GitHub Actions
   - Auto test → build → deploy on PR
   - Branch previews

6. **Database Optimization**
   - Add indexes cho queries thường dùng
   - Setup RLS (Row Level Security) policies
   - Backup strategy

#### Nice to Have
7. **Design System** (Storybook for components)
8. **Accessibility Audit** (a11y compliance)
9. **PWA Support** (offline capability, push notifications)

---

## 📊 CURRENT STATUS

### ✅ Đã hoàn thành
- Auth flow (email/password + Google OAuth)
- Email verification
- Onboarding (Creator + Brand)
- Profile management
- Settings (account, security, password)
- Error handling
- Loading states
- Responsive design

### 🚧 Đang phát triển
- Dashboard (placeholder sẵn sàng)
- Business features (chờ spec)

### 📋 Technical Debt
- **Minimal** - Code quality cao, technical decisions đúng
- Chỉ có duplicate code nhỏ ở validation logic
- Không có major refactor cần thiết

---

## 🎓 LEARNING & BEST PRACTICES

### Quyết định đúng
✅ Dùng Vite (fast build)  
✅ Supabase (không cần backend riêng)  
✅ React Query (chỉ cho server state)  
✅ TypeScript strict mode (catch bugs sớm)  
✅ Feature-based folder structure (dễ scale)  
✅ ErrorBoundary (stability)  

### Trade-offs Hợp lý
⚖️ Delay 100ms (race condition fix) vs UX impact → OK  
⚖️ Manual validation vs library → OK cho form đơn giản  
⚖️ Client-side routing vs SSR → OK cho SaaS app  

### Patterns Nên Giữ
🔁 Gate pattern (AppGate cho routing logic)  
🔁 Provider pattern (AuthProvider)  
🔁 Feature modules (landing, auth, dashboard)  
🔁 Shared UI components (components/ui)  

---

## 📞 CONTACT & HANDOVER

### Codebase Ready
- ✅ Build thành công
- ✅ TypeScript no errors
- ✅ Git history sạch (3 commits cho 3 phases)
- ✅ Comments rõ ràng trong code

### Knowledge Transfer
- Đọc file này trước
- Review 3 commits: Phase 1, 2, 3
- Chạy local: `npm install` → `npm run dev`
- Check `.env.example` cho env vars

### Next Developer Should Know
1. **Auth flow** phức tạp (email verify, OAuth, role selection)
2. **Profile data** dùng React Query → check cache khi debug
3. **Validation logic** ở onboarding/profile → extend carefully
4. **AppGate** là single source of truth cho routing logic

---

**END OF DOCUMENT**
</file>

<file path="src/vite-env.d.ts">
/// <reference types="vite/client" />
</file>

<file path="src/main.tsx">
import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App'
import './index.css'

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>,
)
</file>

<file path="index.html">
<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/logo/logo.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ALINO - Quản lý hợp tác Creator–Brand</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
</file>

<file path="README.md">
# MVP Codebase

A clean, modern, production-oriented MVP environment built with Next.js, TypeScript, and React.

## Tech Stack

- Node.js (LTS)
- TypeScript (strict mode)
- React
- Next.js (App Router)
- npm

## Getting Started

### Installation

```bash
npm install
```

### Development

```bash
npm run dev
```

This starts the development server at [http://localhost:3000](http://localhost:3000).

### Build

```bash
npm run build
```

### Production

```bash
npm start
```

### Backup

```bash
npm run backup
```

This script:
1. Runs repomix to bundle the entire codebase
2. Commits the repomix output
3. Pushes to the connected GitHub repository

## Project Structure

- `app/` - UI components and routes (Next.js App Router)
- `core/` - Domain models, types, and business logic
- `infra/` - Backend integration, auth, and external services
- `lib/` - Shared utilities and helpers
- `scripts/` - Build and utility scripts
- `public/` - Static assets

## Environment Variables

Copy `.env.example` to `.env.local` and fill in your values. Never commit `.env.local` or any files containing secrets.

## TypeScript

The project uses TypeScript in strict mode with absolute imports:
- `@/app` - App directory
- `@/core` - Core business logic
- `@/infra` - Infrastructure code
- `@/lib` - Shared utilities
</file>

<file path="tailwind.config.js">
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: ["./index.html", "./src/**/*.{js,ts,jsx,tsx}"],
  theme: {
    extend: {
      fontFamily: {
        sans: ['Inter', 'system-ui', 'sans-serif'],
      },
      colors: {
        background: '#FFFFFF',
        foreground: '#0A0A0A',
        border: '#E5E7EB',
      },
    },
  },
  plugins: [],
}
</file>

<file path="vite.config.ts">
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import path from 'path'

export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
    },
  },
  server: {
    host: true,
    port: 3000,
  },
})
</file>

<file path="src/index.css">
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  * {
    @apply border-border;
  }
  
  body {
    @apply bg-background text-foreground;
    font-family: 'Inter', system-ui, sans-serif;
  }
}

.underline-gradient {
  position: relative;
}

.underline-gradient::after {
  content: '';
  position: absolute;
  bottom: -4px;
  left: 0;
  width: 0;
  height: 2px;
  background: linear-gradient(90deg, #6366F1, #EC4899);
  transition: width 0.3s ease;
}

.underline-gradient:hover::after {
  width: 100%;
}
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2020",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "types": ["vite/client"],
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["src"],
  "exclude": ["node_modules"]
}
</file>

<file path=".env.example">
VITE_SUPABASE_URL=https://iralrlsuxoqbgcjzdpbb.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlyYWxybHN1eG9xYmdjanpkcGJiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY1ODA5ODUsImV4cCI6MjA4MjE1Njk4NX0.e0x5keoaE0GlXehvTA05LlzGhZWh63FHROkAz9kPqZU
</file>

<file path=".gitignore">
# =====================
# Dependencies
# =====================
node_modules/
.pnp
.pnp.js

# =====================
# Next.js / Build
# =====================
.next/
out/
build/
dist/

# =====================
# Environment variables
# =====================
.env
.env.local
.env.*.local

# =====================
# Logs
# =====================
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# =====================
# OS / Editor
# =====================
.DS_Store

# =====================
# TypeScript
# =====================
*.tsbuildinfo
next-env.d.ts

# =====================
# Repomix (local only)
# =====================
repomix-output.*

# =====================
# MS Office temp files
# =====================
~$*.docx
~$*.xlsx
~$*.pptx
</file>

<file path="src/App.tsx">
import { BrowserRouter } from 'react-router-dom'
import { Router } from './router'
import Header from './components/layout/Header'
import Footer from './components/layout/Footer'

function App() {
  return (
    <BrowserRouter>
      <div className="min-h-screen flex flex-col">
        <Header />
        <main className="flex-1">
          <Router />
        </main>
        <Footer />
      </div>
    </BrowserRouter>
  )
}

export default App
</file>

<file path="package.json">
{
  "name": "alino-vite",
  "version": "0.1.0",
  "private": true,
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview",
    "backup": "git add -A && git commit -m \"backup\" || echo \"No changes to commit\" && git push"
  },
  "dependencies": {
    "@supabase/supabase-js": "^2.89.0",
    "react": "^18.3.1",
    "react-dom": "^18.3.1",
    "react-router-dom": "^6.26.0",
    "react-icons": "^5.5.0"
  },
  "devDependencies": {
    "@types/react": "^18.3.3",
    "@types/react-dom": "^18.3.0",
    "@vitejs/plugin-react": "^4.3.1",
    "autoprefixer": "^10.4.23",
    "postcss": "^8.5.6",
    "tailwindcss": "^3.4.1",
    "typescript": "^5.5.4",
    "vite": "^5.4.0"
  }
}
</file>

</files>
